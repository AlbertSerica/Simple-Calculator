<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>Simple Calculator</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="app/css/bootstrap.min.css">
    
   


    <link rel="stylesheet" href="app/css/set_4.css">
    <style>
        html,
        body,
        #app {
            height: 100%;
            width: 100%;
            padding: 0;
            margin: 0;
            overflow: hidden;
            position:relative;
        }
        #standard,#scientific{
            height: 90%;
            width: 100%;
            padding: 0;
            margin: 0;
            overflow: hidden;
            position:absolute;
            bottom: 0;
           
        }
        .keys{
            animation:bounceIn  0.5s ease 0s 1 normal;
        }
        #standard.medium .el-row.panel,
        #scientific.medium .el-row.panel {
            height: 16%;
        }
        
        #standard.medium .keys,
        #scientific.medium .keys{
            height:84%;
        }
       #standard.medium .el-row,
       #scientific.medium .el-row{
            height: 16.66667%;
        }

        #standard.large .keys{
            height:80%;
        }
        #standard.large .el-row.panel {
            height:20%;
        
        }
        #standard.large .el-row{
            height:20%;
        }
    </style>
    <script src="app/js/vue.js"></script>
    <script src="app/js/vue-router.js"></script>

    
    <!-- 引入样式 -->
<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-default/index.css">
<!-- 引入组件库 -->
<script src="https://unpkg.com/element-ui/lib/index.js"></script>

</head>

<body>
    <div id="app">
          <div>
          <router-link to="/">标准</router-link>
            <router-link to="/scientific">科学</router-link>
            <router-view></router-view>
          </div>
     
            
        
      
    </div>
</body>
<template id="tpl_Standard">
    <div id="standard" :class="[{medium:isMedium},{large:isLarge}]">
         <screen-panel></screen-panel>
         <div class="keys">
            <template v-if="layout =='medium'">
            
            
                <el-row>
                    <btn button-caption="%"></btn>
                    <btn button-caption="√"></btn>
                    <btn button-caption="x^2"></btn>
                    <btn button-caption="1/x"></btn>
                </el-row>
                <el-row>
                    <btn button-caption="CE"></btn>
                    <btn button-caption="C"></btn>
                    <btn button-caption="DELETE"></btn>
                    <btn button-caption="/"></btn>
                </el-row>
                <el-row>
                    <btn button-caption="7"></btn>
                    <btn button-caption="8"></btn>
                    <btn button-caption="9"></btn>
                    <btn button-caption="*"></btn>
                </el-row>
                <el-row>
                    <btn button-caption="4"></btn>
                    <btn button-caption="5"></btn>
                    <btn button-caption="6"></btn>
                    <btn button-caption="-"></btn>
                </el-row>
                <el-row>
                    <btn button-caption="1"></btn>
                    <btn button-caption="2"></btn>
                    <btn button-caption="3"></btn>
                    <btn button-caption="+"></btn>
                </el-row>
                <el-row>
                    <btn button-caption="+/-"></btn>
                    <btn button-caption="0"></btn>
                    <btn button-caption="."></btn>
                    <btn button-caption="="></btn>
                </el-row>
        
            </template>
            <template v-if="layout=='large'">
                    
                    <el-row>
                        <btn button-caption="%"></btn>
                        <btn button-caption="CE"></btn>
                        <btn button-caption="C"></btn>
                        <btn button-caption="DELETE"></btn>
                        <btn button-caption="/"></btn>
                    </el-row>
                    <el-row>
                        <btn button-caption="√"></btn>
                        <btn button-caption="7"></btn>
                        <btn button-caption="8"></btn>
                        <btn button-caption="9"></btn>
                        <btn button-caption="*"></btn>
                    </el-row>
                    <el-row>
                        <btn button-caption="x^2"></btn>
                        <btn button-caption="4"></btn>
                        <btn button-caption="5"></btn>
                        <btn button-caption="6"></btn>
                        <btn button-caption="-"></btn>
                    </el-row>
                    <el-row>
                        <btn button-caption="x^3"></btn>
                        <btn button-caption="1"></btn>
                        <btn button-caption="2"></btn>
                        <btn button-caption="3"></btn>
                        <btn button-caption="+"></btn>
                    </el-row>
                    <el-row>
                        <btn button-caption="1/x"></btn>
                        <btn button-caption="+/-"></btn>
                        <btn button-caption="0"></btn>
                        <btn button-caption="."></btn>
                        <btn button-caption="="></btn>
                    </el-row>
            </template>
        </div>
    </div>
</template>
<template id="tpl_Scientific">
        <div id="scientific" :class="[{medium:isMedium},{large:isLarge}]">
             <screen-panel></screen-panel>
             <div class="keys">
                <template v-if="layout =='medium'">
                    <el-row>
                        <btn button-caption="%"></btn>
                        <btn button-caption="√"></btn>
                        <btn button-caption="x^2"></btn>
                        <btn button-caption="1/x"></btn>
                        <btn button-caption="Mod"></btn>
                    </el-row>
                    <el-row>
                        <btn button-caption="↑"></btn>
                        <btn button-caption="CE"></btn>
                        <btn button-caption="C"></btn>
                        <btn button-caption="DELETE"></btn>
                        <btn button-caption="/"></btn>
                    </el-row>
                    <el-row>
                        <btn button-caption="π"></btn>
                        <btn button-caption="7"></btn>
                        <btn button-caption="8"></btn>
                        <btn button-caption="9"></btn>
                        <btn button-caption="*"></btn>
                    </el-row>
                    <el-row>
                        <btn button-caption="n!"></btn>
                        <btn button-caption="4"></btn>
                        <btn button-caption="5"></btn>
                        <btn button-caption="6"></btn>
                        <btn button-caption="-"></btn>
                    </el-row>
                    <el-row>
                        <btn button-caption="+/-"></btn>
                        <btn button-caption="1"></btn>
                        <btn button-caption="2"></btn>
                        <btn button-caption="3"></btn>
                        <btn button-caption="+"></btn>
                    </el-row>
                    <el-row>
                        <btn button-caption="("></btn>
                        <btn button-caption=")"></btn>
                        <btn button-caption="0"></btn>
                        <btn button-caption="."></btn>
                        <btn button-caption="="></btn>
                    </el-row>
            
                </template>
                <template v-if="layout=='large'">
                        
                        <el-row>
                            <btn button-caption="%"></btn>
                            <btn button-caption="CE"></btn>
                            <btn button-caption="C"></btn>
                            <btn button-caption="DELETE"></btn>
                            <btn button-caption="/"></btn>
                        </el-row>
                        <el-row>
                            <btn button-caption="√"></btn>
                            <btn button-caption="7"></btn>
                            <btn button-caption="8"></btn>
                            <btn button-caption="9"></btn>
                            <btn button-caption="*"></btn>
                        </el-row>
                        <el-row>
                            <btn button-caption="x^2"></btn>
                            <btn button-caption="4"></btn>
                            <btn button-caption="5"></btn>
                            <btn button-caption="6"></btn>
                            <btn button-caption="-"></btn>
                        </el-row>
                        <el-row>
                            <btn button-caption="x^3"></btn>
                            <btn button-caption="1"></btn>
                            <btn button-caption="2"></btn>
                            <btn button-caption="3"></btn>
                            <btn button-caption="+"></btn>
                        </el-row>
                        <el-row>
                            <btn button-caption="1/x"></btn>
                            <btn button-caption="+/-"></btn>
                            <btn button-caption="0"></btn>
                            <btn button-caption="."></btn>
                            <btn button-caption="="></btn>
                        </el-row>
                </template>
            </div>
        </div>
</template>
    

<script>
    var Event=new Vue();//事件绑定器，用于平行组件间通信
    Vue.component("standard",{
        template:"#tpl_Standard",
        data(){
            return {
                screenWidth: document.body.clientWidth,//监听窗口变化
                layout:"medium",
                isMedium:true,
                isLarge:false,
            }
        },
    
        mounted:function(){
            const _self = this;
            window.onresize=function temp(){
                _self.screenWidth=document.body.clientWidth;
                if(_self.screenWidth>=992){
                    _self.layout="large";
                    _self.isLarge=true;
                    _self.isMedium=false;
                }
                else{
                    _self.layout="medium";
                    _self.isMedium=true;
                    _self.isLarge=false;
                }
               
            }
        }
    });
    Vue.component("scientific",{
        template:"#tpl_Scientific",
        data(){
            return {
                screenWidth: document.body.clientWidth,//监听窗口变化
                layout:"medium",
                isMedium:true,
                isLarge:false,
            }
        },
    
        mounted:function(){
            const _self = this;
            window.onresize=function temp(){
                _self.screenWidth=document.body.clientWidth;
                if(_self.screenWidth>=9920){
                    _self.layout="large";
                    _self.isLarge=true;
                    _self.isMedium=false;
                }
                else{
                    _self.layout="medium";
                    _self.isMedium=true;
                    _self.isLarge=false;
                }
               
            }
        }
    });
    Vue.component("btn",{
        props: ['buttonCaption'],
        template: `
            <div @click="btnOnClick" class="set_4_button4 raised hoverable" >
                <div class="anim"></div><span>{{buttonCaption}}</span>
            </div>`,
        data:function(){
            return{
                allowed:true
            }
        },
        methods:{
            btnOnClick:function(){
                if(this.allowed){
                    Event.$emit('pushKey',this.buttonCaption)//触发事件
                }
            }
        },
        mounted:function(){
            var me=this;
            Event.$on("setDotStatus",function(data){
                if(me.buttonCaption=='.'){
                    me.allowed=data;
                }
            })
        }
        
    });
    Vue.filter("numFilter",function(val){
        
        return parseFloat(val);
    });
    Vue.component("screen-panel",{
        template:`
        <el-row class="panel">
            <div style="height:50%;text-align:right">
               <div style="font-size:2em">
                 {{currentExpression}}
                </div>
            </div>
            <div style="height:50%;text-align:right;">
                <div style="font-size:5em;">
                    {{numberToPush}}
                </div>
             </div>
        </el-row>`,
        data:function(){
            return {
                currentExpression:'',
                numberToPush:'0',
               
                needToRefresh:false
            }
        },
        mounted:function(){
            var me=this;
            Event.$on("pushKey",function(data){//监听事件

                if(parseInt(data)||data=='0'){
                    if(me.needToRefresh){
                    me.numberToPush='';
                    
                    me.needToRefresh=false;
                    }
                   me.numberToPush=parseFloat(me.numberToPush+=data);
               
                }
                else if(data=="."){
               
                        me.numberToPush+=data;
                        Event.$emit("setDotStatus",false);
                  
                   
                }
                else if(data=="DELETE"){
                    me.numberToPush=me.numberToPush.slice(0,-1);
                    
                }
                else if (data=='C'){
                    me.currentExpression="";
                }
                else if(data=='CE'){
                   me.numberToPush="0";
                 me.numberToPush="";
                }
                else if(data=='+'||data=='-'||data=='*'||data=="/"){

                    if(me.numberToPush!=''){
                       
                        me.currentExpression+=me.numberToPush+data;
                        me.numberToPush='';
                        Event.$emit("setDotStatus",true);
                    }
                    else{
                        me.currentExpression=me.currentExpression.slice(0,-1)+data;
                    }
                }
                else if(data=='+/-'){
                    if(!me.switched){
                        me.numberToPush='-'+me.numberToPush;
                           
                    }
                    else{
                        me.numberToPush=me.numberToPush.slice(1);                       
                    }
                    me.switched=!me.switched;
                    me.numberToPush=parseFloat(me.numberToPush);
                }
                else if(data=='='){
                    console.log(me.numberToPush);
                    me.currentExpression+=me.numberToPush;                  
                    me.numberToPush=Math.round(eval('('+me.currentExpression+')')*100)/100;
                    me.needToRefresh=true;
                   
                    me.currentExpression='';

                    Event.$emit("setDotStatus",true);
                }
            })
        }
    });
    var routes=[
        {
            path:'/',
            component:{
                template:`
                <standard></standard>
                `,
            }  
        },
        {
            path:'/scientific',
            component:{
                template:`
               <scientific></scientific>
                `
            }
        }
    ];
    var router = new VueRouter({
        routes:routes,
    });

    var app = new Vue({
        el: "#app",
        router:router,
      
        
    });
</script>

</html>